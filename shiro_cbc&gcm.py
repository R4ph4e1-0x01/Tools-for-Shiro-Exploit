#python2
#pip install pycrypto
import sys
import base64
import uuid
from random import Random
import subprocess
from Crypto.Cipher import AES



def shiro_gcm(key, data):
    iv = uuid.uuid4().bytes
    cipher = AES.new(base64.b64decode(key), AES.MODE_GCM, iv)
    ciphertext, tag = cipher.encrypt_and_digest(base64.b64decode(data))
    e_text = iv + ciphertext + tag
    base64_ciphertext = base64.b64encode(e_text)
    return base64_ciphertext


key  =  "kPH+bIxk5D2deZiIxcaaaA=="
mode =  AES.MODE_CBC
IV   = uuid.uuid4().bytes
encryptor = AES.new(base64.b64decode(key), mode, IV)

payload=base64.b64decode(sys.argv[1])
BS   = AES.block_size
pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()
payload=pad(payload)

print("\nCBC:\n")
print(base64.b64encode(IV + encryptor.encrypt(payload)))
print("----------------------")
print("\nGCM:\n")
print(shiro_gcm(key, sys.argv[1]))